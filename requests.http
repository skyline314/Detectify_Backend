@baseUrl = http://127.0.0.1:5000
@contentType = application/json

# Variabel untuk menyimpan token (VS Code REST Client mendukung @name)
# Ganti token manual di bawah jika variabel tidak jalan di versi extension Anda.

### ------------------------------------------------------------
### 1. Registrasi Pengguna Baru
### ------------------------------------------------------------
POST {{baseUrl}}/auth/register
Content-Type: {{contentType}}

{
    "email": "user_test_01@example.com",
    "password": "password_rahasia_123"
}

### ------------------------------------------------------------
### 2. Login (Dapatkan Token JWT)
### ------------------------------------------------------------
# @name login
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
    "email": "user_test_01@example.com",
    "password": "password_rahasia_123"
}

### Simpan Token dari Response di atas ke variabel ini (Manual Copy-Paste jika perlu)
@authToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTc2NDA1ODg1NiwianRpIjoiNTI5MTQyNTMtOWE0OS00YmYxLWIyMzEtYjQ3MDExNDBjZTE1IiwidHlwZSI6ImFjY2VzcyIsInN1YiI6ImZlYWZmZmZmLWViNGMtNGI0NC1iYTZjLTI2MmY0NTYyMmZjMiIsIm5iZiI6MTc2NDA1ODg1NiwiY3NyZiI6IjJlMzgzNTQ1LTk0YTMtNGE5Yi1iNmE5LWU1OTg3NmNhMjUyMSIsImV4cCI6MTc2NDA1OTc1Nn0.PxtdHcOWp-R_-lSOIUIaWM4nuQVNbWfVLZtSE5LQTOg


### ------------------------------------------------------------
### 3. Cek Profil / History (Tes Token)
### ------------------------------------------------------------
GET {{baseUrl}}/api/history
Authorization: Bearer {{authToken}}


### ------------------------------------------------------------
### 4. Upload Audio (Memicu Celery Worker)
### ------------------------------------------------------------
# CATATAN: Ganti path file di bawah dengan lokasi file audio asli di PC Anda.
# Gunakan path relatif atau absolut tanpa spasi jika memungkinkan.
# Jika file ada di root folder proyek, cukup gunakan < ./namafile.mp3
POST {{baseUrl}}/api/analysis/audio
Authorization: Bearer {{authToken}}
Content-Type: multipart/form-data; boundary=MyBoundary

--MyBoundary
Content-Disposition: form-data; name="file"; filename="test_suara.mp3"
Content-Type: audio/mpeg

< ./celery_worker/assets/test.mp3
--MyBoundary--

# JIKA GAGAL DI SINI: Gunakan Postman untuk langkah upload ini.


### ------------------------------------------------------------
### 5. Cek Status Analisis (Polling)
### ------------------------------------------------------------
# Ganti ID di bawah dengan 'analysis_id' yang Anda dapat dari respons Upload
@analysisId = 0c22a0f3-38a8-4288-9aaa-306053e63b01

GET {{baseUrl}}/api/analysis/{{analysisId}}
Authorization: Bearer {{authToken}}


### ------------------------------------------------------------
### 6. Tes Kuota Habis (Opsional)
### ------------------------------------------------------------
# Ulangi request Upload (No. 4) sebanyak 4 kali untuk melihat error kuota.